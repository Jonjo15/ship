(()=>{"use strict";const e={playerGrid:document.querySelector(".playerGrid"),playerSquares:document.querySelectorAll(".playerGrid div"),aiSquares:document.querySelectorAll(".cpuGrid div"),cpuGrid:document.querySelector(".cpuGrid"),startBtn:document.querySelector("#startBtn")},t=e=>{const t=new Array(e).fill(!1);return{getLength:()=>e,hit:e=>(t[e]=!0,t),isSunk:()=>t.every((e=>e)),getHitArray:()=>t}},r=(e=!1)=>{let r,a,l,s=((e=!1)=>{const r=[];let a=0;for(let e=1;e<6;e++)r.push(t(e));let l=new Array(100).fill(!1);const s=(e,t,r=!0)=>{let a,s=e.getLength();if(r){let e;a=i(s);for(let r=0;r<s;r++)e=a+r+"-"+t+r,l[a+r]=e,e=""}else{let e;a=o(s);for(let r=0;r<s;r++){let s=10*r;e=a+s+"-"+t+r,l[a+s]=e,e=""}}},i=e=>{let t=Math.floor(100*Math.random()),r=[];if(t%10+e<=10){for(let a=0;a<e;a++)r.push(l[t+a]);return r.every((e=>!1===e))?t:i(e)}return i(e)},o=e=>{let t=10*(e-1),r=Math.floor(100*Math.random()-t),a=[];for(let t=0;t<e;t++){let e=10*t;a.push(l[r+e])}return a.every((e=>!1===e))?r:o(e)};return{boardArray:l,setIsHorizontal:e=>e,ships:r,receiveAttack:e=>{if("miss"===l[e]||"hit"===l[e])return 0;if(!1===l[e])return l[e]="miss",a+=1,!1;if("string"==typeof l[e]){let t=parseInt(l[e].slice(-1)),a=parseInt(l[e].slice(-2,-1));return r[a].hit(t),l[e]="hit",!0}},getMissedCount:()=>a,allShipsSunk:()=>r.every((e=>e.isSunk())),placeShipsRandomly:s,aiPlaceShips:()=>{const e=[!0,!1];r.forEach(((t,r)=>{let a=Math.floor(Math.random()*e.length);s(t,r,e[a])}))}}})(e);r=!e;const i=e=>{let t,r=Math.floor(100*Math.random());return t=e.receiveAttack(r),0===t?i(e):(l=t,a=r,!0)};return{isAi:()=>e,getTurn:()=>r,setTurn:e=>r=e,gameboard:s,computerMakeRandomPlay:i,getLastAiAttempt:()=>a,getLastResult:()=>l}},a=(()=>{let t=!1,a=r(),l=r(!0);a.gameboard.aiPlaceShips(),l.gameboard.aiPlaceShips();let s,i=!1;const o=()=>{a.gameboard.allShipsSunk()?(s="CPU",t=!0):l.gameboard.allShipsSunk()&&(s="YOU",t=!0)},n=t=>{if(a.getTurn())a.getTurn()&&"boolean"==typeof l.gameboard.receiveAttack(t)&&a.setTurn(!1);else{l.computerMakeRandomPlay(a.gameboard);let t=l.getLastResult(),r=l.getLastAiAttempt();t?(console.log(document.querySelectorAll(".playerGrid")),e.playerSquares[r].textContent="X"):e.playerSquares[r].textContent="miss",a.setTurn(!0)}o()},d=()=>{if(i||((console.log(e),{renderStart:(t,r)=>{t.gameboard.boardArray.forEach(((t,r)=>{t?"string"==typeof t&&(e.playerSquares[r].classList.add("shipPart"),e.playerSquares[r].dataset.shipId=t):e.playerSquares[r].classList.add("emptySquare")})),r.gameboard.boardArray.forEach(((t,r)=>{t?"string"==typeof t&&(e.aiSquares[r].classList.add("shipPart"),e.aiSquares[r].dataset.shipId=t):e.aiSquares[r].classList.add("emptySquare")}))}}).renderStart(a,l),i=!0),n(),!t)return d()};return{gameLoop:d,reset:()=>{},checkForWin:o,playTurn:n}})();let l=Object.assign(e);function s(e){for(let t=0;t<100;t++){let r=document.createElement("div");r.classList.add("gridDiv"),r.dataset.id=t,e.appendChild(r)}}s(e.playerGrid),s(e.cpuGrid),l.aiSquares=document.querySelectorAll(".cpuGrid div"),l.playerSquares=document.querySelectorAll(".playerGrid div"),e.aiSquares.forEach((e=>{e.addEventListener("click",(e=>{console.log(e.target.dataset.id),a.playTurn(+e.target.dataset.id)}))})),l.startBtn.addEventListener("click",(e=>{a.gameLoop()}))})();