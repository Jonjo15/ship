(()=>{"use strict";var e={877:(e,t,r)=>{r.d(t,{H:()=>l});const a={playerGrid:document.querySelector(".playerGrid"),playerSquares:document.querySelectorAll(".playerGrid div"),aiSquares:document.querySelectorAll(".cpuGrid div"),cpuGrid:document.querySelector(".cpuGrid"),startBtn:document.querySelector("#startBtn"),info:document.querySelector(".info"),resetBtn:document.getElementById("resetBtn"),remShipsPlayer:document.querySelector(".remShipsPlayer"),remShipsAi:document.querySelector(".remShipsAi"),selectGrid:document.querySelector(".selectShipsGrid"),directionBtn:document.querySelector("#directionBtn"),selectShips:[...document.querySelectorAll(".selectShipsGrid div")].filter((e=>e.hasAttribute("draggable"))),autoPlaceBtn:document.getElementById("autoPlace")},s=e=>{const t=new Array(e).fill(!1);return{getLength:()=>e,hit:e=>(t[e]=!0,t),isSunk:()=>t.every((e=>e)),getHitArray:()=>t}},i=(e=!1)=>{let t,r,a,i=((e=!1)=>{const t=[];let r=0,a=15;for(let e=1;e<6;e++)t.push(s(e));let i=new Array(100).fill(!1);const n=(e,t,r=!0)=>{let a,s=e.getLength();if(r){let e;a=l(s);for(let r=0;r<s;r++)e=a+r+"-"+t+r,i[a+r]=e,e=""}else{let e;a=o(s);for(let r=0;r<s;r++){let s=10*r;e=a+s+"-"+t+r,i[a+s]=e,e=""}}},l=e=>{let t=Math.floor(100*Math.random()),r=[];if(t%10+e<=10){for(let a=0;a<e;a++)r.push(i[t+a]);return r.every((e=>!1===e))?t:l(e)}return l(e)},o=e=>{let t=10*(e-1),r=Math.floor(100*Math.random()-t),a=[];for(let t=0;t<e;t++){let e=10*t;a.push(i[r+e])}return a.every((e=>!1===e))?r:o(e)};return{boardArray:i,setIsHorizontal:e=>e,ships:t,receiveAttack:e=>{if("miss"===i[e]||"hit"===i[e])return 0;if(!1===i[e])return i[e]="miss",r+=1,!1;if("string"==typeof i[e]){let r=parseInt(i[e].slice(-1)),s=parseInt(i[e].slice(-2,-1));return t[s].hit(r),i[e]="hit",a-=1,!0}},getMissedCount:()=>r,allShipsSunk:()=>t.every((e=>e.isSunk())),placeShipsRandomly:n,aiPlaceShips:()=>{const e=[!0,!1];t.forEach(((t,r)=>{let a=Math.floor(Math.random()*e.length);n(t,r,e[a])}))},getRemainingShips:()=>a,placePlayersShip:(e,t,r)=>{if(r){let r=[];for(let a=0;a<t;a++)r.push(i[e+a]);if(r.every((e=>!1===e))){let r;for(let a=0;a<t;a++)r=e+a+"-"+(t-1)+a,i[e+a]=r,r="";return!0}return!1}{let r=[];for(let a=0;a<t;a++)r.push(i[e+10*a]);if(r.every((e=>!1===e))){let r;for(let a=0;a<t;a++)r=e+10*a+"-"+(t-1)+a,i[e+10*a]=r,r="";return!0}return!1}}}})(e),n=!0,l=[],o=[];t=!e;const d=e=>{let t,s;return s=0===o.length?Math.floor(100*Math.random()):o.pop(),t=e.receiveAttack(s),0===t?d(e):t?([s+1,s-1,s+10,s-10].filter((e=>{return!((t=e)>99||t<0||l.includes(t));var t})).forEach((e=>o.push(e))),a=t,r=s,l.push(r),!0):(a=t,r=s,l.push(r),!0)};return{isAi:()=>e,getTurn:()=>t,setTurn:e=>t=e,gameboard:i,computerMakeRandomPlay:d,getLastAiAttempt:()=>r,getLastResult:()=>a,getHorizontal:()=>n,setHorizontal:e=>n=e}},n=()=>{const e=e=>{let t=document.createElement("div");t.classList.add("shipContainerHorizontal"),t.classList.add("ship"+e),t.dataset.id=e-1,t.style.width=30*e+"px",t.setAttribute("draggable",!0);for(let r=0;r<e;r++){let a=document.createElement("div");a.dataset.id=""+e+r,t.appendChild(a)}return t};return{renderStart:(t,r)=>{(t=>{console.log(t),t.gameboard.ships.forEach(((t,r)=>{a.selectGrid.appendChild(e(t.getLength()))})),a.selectShips=[...document.querySelectorAll(".selectShipsGrid div")].filter((e=>e.hasAttribute("draggable")))})(t),a.directionBtn.style.display="inline-block",a.info.textContent="Your Turn",a.remShipsPlayer.textContent="Your ship positions left: "+t.gameboard.getRemainingShips(),a.remShipsAi.textContent="Computer's ship positions left: "+r.gameboard.getRemainingShips(),r.gameboard.boardArray.forEach(((e,t)=>{e?"string"==typeof e&&(a.aiSquares[t].classList.add("emptySquare"),a.aiSquares[t].dataset.shipId=e):a.aiSquares[t].classList.add("emptySquare")}))},changeShipDirection:()=>{a.selectShips.forEach(((e,t)=>{e.classList.contains("shipContainerHorizontal")?(e.classList.remove("shipContainerHorizontal"),e.classList.add("shipContainerVertical"),e.style.height=30*(t+1)+"px",e.style.width="30px"):(e.classList.remove("shipContainerVertical"),e.classList.add("shipContainerHorizontal"),e.style.width=30*(t+1)+"px",e.style.height="30px")}))},autoRenderPlayer:e=>{e.gameboard.boardArray.forEach(((e,t)=>{e?"string"==typeof e&&(a.playerSquares[t].classList.add("ship"+(parseInt(e.slice(-2,-1))+1)),a.playerSquares[t].dataset.shipId=e):a.playerSquares[t].classList.add("emptySquare")}))},renderPlayerEmptyBoard:()=>{console.log(a.playerSquares),a.playerSquares.forEach((e=>e.classList.add("emptySquare")))},renderPlayerShip:(e,t)=>{e.gameboard.boardArray.forEach(((e,r)=>{"string"!=typeof e||a.playerSquares[r].hasAttribute("data-ship-id")||(a.playerSquares[r].className="",a.playerSquares[r].classList.add("ship"+t),a.playerSquares[r].dataset.shipId=e)}))}}};let l,o=Object.assign(a);function d(e){for(let t=0;t<100;t++){let r=document.createElement("div");r.dataset.id=t,e.appendChild(r)}}d(a.playerGrid),d(a.cpuGrid),o.aiSquares=document.querySelectorAll(".cpuGrid div"),o.playerSquares=document.querySelectorAll(".playerGrid div"),o.startBtn.addEventListener("click",(e=>{l=(()=>{let e=!1,t=i(),r=i(!0);r.gameboard.aiPlaceShips();let s,l=!1;const o=()=>t.gameboard.allShipsSunk()?(s="CPU",e=!0,!0):!!r.gameboard.allShipsSunk()&&(s="YOU",e=!0,!0),d=()=>{if(!t.getTurn()){r.computerMakeRandomPlay(t.gameboard);let e=r.getLastResult(),i=r.getLastAiAttempt();e?(a.playerSquares[i].className="",a.playerSquares[i].classList.add("hit"),a.remShipsPlayer.textContent="Your ship positions left: "+t.gameboard.getRemainingShips(),o()?(a.playerGrid.classList.add("gameOver"),a.cpuGrid.classList.add("gameOver"),a.info.textContent=s+" won"):(t.setTurn(!0),a.info.textContent="Your turn")):(a.playerSquares[i].classList.add("miss"),t.setTurn(!0),a.info.textContent="Your turn")}o()},c=e=>{e.forEach((e=>{e.className="",e.hasAttribute("data-ship-id")&&e.removeAttribute("data-ship-id")}))};return{gameLoop:()=>{if(!l){let e=n();e.renderStart(t,r),e.renderPlayerEmptyBoard(),l=!0}},reset:()=>{c(a.aiSquares),c(a.playerSquares),a.selectShips.forEach((e=>{e.remove()})),e=!1,a.info.textContent="",a.remShipsPlayer.textContent="",a.remShipsAi.textContent="",a.startBtn.style.display="inline-block",a.directionBtn.style.display="inline-block",a.autoPlaceBtn.style.display="inline-block",a.resetBtn.style.display="none",a.selectGrid.style.display="flex",a.playerGrid.classList.remove("gameOver"),a.cpuGrid.classList.remove("gameOver"),a.info.textContent="Your turn"},checkForWin:o,playTurnAi:d,getGameOver:()=>e,playerAttack:i=>{if(!t.getTurn()||e)return;let n=r.gameboard.receiveAttack(i);if(0!==n)if(n){if(a.aiSquares[i].classList.add("hit"),t.setTurn(!1),!o())return a.info.textContent="Ai turn",a.remShipsAi.textContent="Computer's ship positions left: "+r.gameboard.getRemainingShips(),setTimeout((()=>d()),1e3),!0;a.playerGrid.classList.add("gameOver"),a.cpuGrid.classList.add("gameOver"),a.info.textContent=s+" won"}else if(!n)return t.setTurn(!1),a.aiSquares[i].classList.add("miss"),a.info.textContent="Ai turn",setTimeout((()=>d()),1e3),!0},player1:t}})(),l.gameLoop(),o.startBtn.style.display="none",o.resetBtn.style.display="inline-block",a.autoPlaceBtn.style.display="inline-block",(()=>{let e,t,r,s,i=0;a.selectShips.forEach((a=>{a.addEventListener("dragstart",(t=>{r=t.target,console.log(r),e=parseInt(t.target.dataset.id)+1,s=!!a.classList.contains("shipContainerHorizontal")})),a.childNodes.forEach((e=>e.addEventListener("mousedown",(e=>{t=parseInt(e.target.dataset.id.slice(-1))}))))})),a.playerSquares.forEach((e=>{e.addEventListener("dragenter",(e=>o(e))),e.addEventListener("dragleave",(e=>d(e))),e.addEventListener("drop",(e=>p(e))),e.addEventListener("dragover",(function(e){e.preventDefault()})),e.addEventListener("dragend",(e=>c(e)))}));const o=e=>{e.preventDefault()},d=e=>{e.preventDefault()},c=e=>{e.preventDefault()},p=o=>{if(s){console.log(e);let s=t,d=parseInt(o.target.dataset.id)-s;e+d%10<=10?l.player1.gameboard.placePlayersShip(d,e,!0)&&(console.log("success"),r.remove(),n().renderPlayerShip(l.player1,e),a.autoPlaceBtn.style.display="none",i+=1,5===i&&(a.directionBtn.style.display="none",a.selectGrid.style.display="none",y(),u())):console.log("fail")}else{let s=10*t,d=parseInt(o.target.dataset.id)-s,c=99-10*(e-1);d>=0&&d<=c?(console.log("success"),l.player1.gameboard.placePlayersShip(d,e,!1)&&(r.remove(),n().renderPlayerShip(l.player1,e),a.autoPlaceBtn.style.display="none",i+=1,5===i&&(a.directionBtn.style.display="none",a.selectGrid.style.display="none",y(),u()))):console.log("fail")}},u=()=>{e=null,t=null,r=null,i=0,s=null},y=()=>{a.playerSquares.forEach((e=>{e.removeEventListener("dragenter",(e=>o(e))),e.removeEventListener("dragleave",(e=>d(e))),e.removeEventListener("drop",(e=>p(e))),e.removeEventListener("dragover",(function(e){e.preventDefault()})),e.removeEventListener("dragend",(e=>c(e)))}))}})()})),a.aiSquares.forEach((e=>{e.addEventListener("click",(e=>{l.playerAttack(+e.target.dataset.id)}))})),a.resetBtn.addEventListener("click",(e=>l.reset())),a.directionBtn.addEventListener("click",(e=>n().changeShipDirection())),a.autoPlaceBtn.addEventListener("click",(e=>{l.player1.gameboard.aiPlaceShips(),n().autoRenderPlayer(l.player1),a.selectShips.forEach((e=>e.remove())),a.directionBtn.style.display="none",a.autoPlaceBtn.style.display="none",a.selectGrid.style.display="none"}))}},t={};function r(a){if(t[a])return t[a].exports;var s=t[a]={exports:{}};return e[a](s,s.exports,r),s.exports}r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r(877)})();